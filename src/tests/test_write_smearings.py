import numpy as np
import pandas as pd

import src.core.write_files as wf


def test_wf_write_smearings():
    example_scales_smearings = np.array(
        [
            1.00305413e00,
            1.00110835e00,
            9.99230552e-01,
            9.97865911e-01,
            1.00285920e00,
            1.00024286e00,
            9.98117276e-01,
            9.97900036e-01,
            1.00034651e00,
            9.99886539e-01,
            9.98236988e-01,
            1.00014074e00,
            9.99866238e-01,
            9.99197177e-01,
            9.99755370e-01,
            9.99788767e-01,
            9.99895850e-01,
            1.00102836e00,
            9.98853520e-01,
            1.00178330e00,
            9.99821751e-01,
            1.00015461e00,
            9.99217447e-01,
            1.00014786e00,
            1.00016824e00,
            1.00119713e00,
            1.00084645e00,
            1.00084739e00,
            9.99810994e-01,
            1.00014767e00,
            1.00113875e00,
            1.00020610e00,
            1.60971944e-02,
            1.12149686e-02,
            0.00000000e00,
            1.50080686e-03,
            1.78037825e-02,
            3.06061361e-03,
            1.52194414e-03,
            0.00000000e00,
            1.39097515e-02,
            1.44802735e-02,
            0.00000000e00,
            1.34378914e-02,
            1.54062022e-02,
            1.11963510e-02,
            0.00000000e00,
            2.57162699e-04,
            0.00000000e00,
            8.15762601e-03,
            9.94960706e-03,
            1.59542583e-02,
            0.00000000e00,
            9.00068723e-03,
            1.31813402e-02,
            1.34023144e-02,
            0.00000000e00,
            4.27150458e-03,
            1.04827428e-02,
            1.86617617e-02,
            0.00000000e00,
            5.97181153e-03,
            6.93517340e-03,
            1.56771889e-02,
        ]
    )

    cats = pd.read_csv("config/cats_step5_stochastic.tsv", sep="\t")
    wf.write_smearings(example_scales_smearings, cats, "test_write_smearings.dat")
